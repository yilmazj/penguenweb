<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Nihilist Penguen: Everest Edition</title>

<style>
body { margin:0; overflow:hidden; background:#111; font-family:'Courier New', Courier, monospace; }
#canvas-container { width:100vw; height:100vh; }
#ui-layer { position:absolute; inset:0; pointer-events:none; z-index:20; }
#timer { position:absolute; top:20px; right:20px; color:#fff; font-weight:bold; display:none; }
#back-btn { position:absolute; top:20px; left:20px; pointer-events:auto; display:none; cursor:pointer; color:#fff; border:2px solid rgba(255,255,255,.5); padding:8px 15px; }
#start-screen { position:absolute; inset:0; display:flex; flex-direction:column; align-items:center; justify-content:center; background:linear-gradient(#e0f0ff,#fff); z-index:30; }
#joystick-zone { position:absolute; bottom:50px; width:160px; height:160px; display:none; z-index:25; border-radius:50%; background:rgba(255,255,255,.1); }
</style>
</head>

<body>

<div id="ui-layer">
  <div id="back-btn" onclick="pauseGame()">â—„ MENÃœ</div>
  <div id="timer">00:00:00</div>
</div>

<div id="start-screen">
  <h1>NIHILIST PENGUEN</h1>
  <button onclick="startGame()">DEVAM / BAÅžLA</button>
</div>

<div id="joystick-zone"></div>
<div id="canvas-container"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/0.160.0/three.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/nipplejs/0.9.0/nipplejs.min.js"></script>

<script>
let scene, camera, renderer;
let penguin, ground, groundMaterial, snowTexture;
let mountainObjects = [];
let joystickManager;

let moveForward = 0;
let rotateY = 0;
let isGameActive = false;

let walkTime = 0;
let worldZ = 0; // ðŸ”¥ DÃœNYA AKIÅžI

function startGame() {
  document.getElementById("start-screen").style.display="none";
  document.getElementById("back-btn").style.display="block";
  document.getElementById("joystick-zone").style.display="block";
  if(!scene){ init3D(); setupJoystick(); }
  isGameActive = true;
  animate();
}

function pauseGame(){
  isGameActive=false;
  document.getElementById("start-screen").style.display="flex";
  document.getElementById("back-btn").style.display="none";
  document.getElementById("joystick-zone").style.display="none";
}

function createSnowTexture(){
  const c=document.createElement("canvas");
  c.width=c.height=1024;
  const x=c.getContext("2d");
  x.fillStyle="#fff"; x.fillRect(0,0,1024,1024);
  for(let i=0;i<60000;i++){
    const g=200+Math.random()*55;
    x.fillStyle=`rgb(${g},${g},${g})`;
    x.fillRect(Math.random()*1024,Math.random()*1024,2,2);
  }
  const t=new THREE.CanvasTexture(c);
  t.wrapS=t.wrapT=THREE.RepeatWrapping;
  t.repeat.set(40,40);
  return t;
}

function init3D(){
  scene=new THREE.Scene();
  scene.background=new THREE.Color(0xcceeff);
  scene.fog=new THREE.FogExp2(0xcceeff,0.0012);

  camera=new THREE.PerspectiveCamera(55,innerWidth/innerHeight,0.1,4000);

  renderer=new THREE.WebGLRenderer({antialias:true});
  renderer.setSize(innerWidth,innerHeight);
  renderer.shadowMap.enabled=true;
  document.getElementById("canvas-container").appendChild(renderer.domElement);

  scene.add(new THREE.HemisphereLight(0xcceeff,0xffffff,0.7));
  const dl=new THREE.DirectionalLight(0xffffff,1.8);
  dl.position.set(100,150,100);
  dl.castShadow=true;
  scene.add(dl);

  snowTexture=createSnowTexture();
  groundMaterial=new THREE.MeshStandardMaterial({map:snowTexture,roughness:.8});
  ground=new THREE.Mesh(new THREE.PlaneGeometry(8000,8000),groundMaterial);
  ground.rotation.x=-Math.PI/2;
  ground.receiveShadow=true;
  scene.add(ground);

  penguin=createPenguin();
  scene.add(penguin);

  initMountains();
  updateCamera();
}

function createPenguin(){
  const g=new THREE.Group();
  g.scale.set(.6,.6,.6);

  const black=new THREE.MeshStandardMaterial({color:0x111});
  const white=new THREE.MeshStandardMaterial({color:0xffffff});
  const orange=new THREE.MeshStandardMaterial({color:0xff8800});

  const body=new THREE.Mesh(new THREE.CapsuleGeometry(.95,1.4,16,32),black);
  body.position.y=2.6; g.add(body);

  const head=new THREE.Mesh(new THREE.CapsuleGeometry(.55,.45,16,24),black);
  head.position.y=4.3; g.add(head);

  const beak=new THREE.Mesh(new THREE.ConeGeometry(.15,.55,16),orange);
  beak.rotation.x=Math.PI/2; beak.position.set(0,4.3,.65); g.add(beak);

  const legGeo=new THREE.CylinderGeometry(.28,.25,.7,12);
  const footGeo=new THREE.CapsuleGeometry(.28,.9,12,16);
  footGeo.scale(1,1,.5);

  function leg(x){
    const lg=new THREE.Group(); lg.position.set(x,1.3,0);
    const l=new THREE.Mesh(legGeo,black); l.position.y=-.1;
    const f=new THREE.Mesh(footGeo,orange); f.rotation.x=Math.PI/2; f.position.set(0,-.45,.35);
    lg.add(l); lg.add(f); return lg;
  }

  const L=leg(.5), R=leg(-.5);
  g.add(L); g.add(R);
  g.userData.legs={left:L,right:R};
  return g;
}

function initMountains(){
  for(let i=0;i<400;i++) spawnMountain(Math.random()*3000);
}

function spawnMountain(z){
  const geo=new THREE.ConeGeometry(300+Math.random()*300,400+Math.random()*400,32,16,true);
  const m=new THREE.Mesh(geo,new THREE.MeshStandardMaterial({map:snowTexture,color:0x999999}));
  const s=2.5+Math.random()*3;
  m.scale.set(s,s,s);
  m.position.set((Math.random()>.5?1:-1)*(200+Math.random()*800),-geo.parameters.height*s/2,z);
  m.rotation.y=Math.random()*Math.PI*2;
  scene.add(m);
  mountainObjects.push(m);
}

function recycleMountains(){
  mountainObjects.forEach(m=>{
    if(m.position.z<worldZ-600){
      m.position.z=worldZ+2000+Math.random()*600;
      m.position.x=(Math.random()>.5?1:-1)*(200+Math.random()*900);
      const s=2.5+Math.random()*3;
      m.scale.set(s,s,s);
      m.rotation.y=Math.random()*Math.PI*2;
    }
  });
}

function setupJoystick(){
  joystickManager=nipplejs.create({
    zone:document.getElementById("joystick-zone"),
    mode:"static",
    position:{top:"50%",left:"50%"},
    size:120
  });

  joystickManager.on("move",(e,d)=>{
    if(d?.vector){
      moveForward=Math.max(0,d.vector.y)*0.02;
      rotateY=-d.vector.x*0.03;
    }
  });

  joystickManager.on("end",()=>{moveForward=0; rotateY=0;});
}

function updateCamera(){
  const off=new THREE.Vector3(0,5.5,-12).applyMatrix4(penguin.matrixWorld);
  camera.position.lerp(off,.05);
  camera.lookAt(penguin.position.x,3.5,penguin.position.z);
}

function animate(){
  if(!isGameActive) return;
  requestAnimationFrame(animate);

  penguin.rotation.y+=rotateY;

  if(moveForward>0.0001){
    worldZ+=moveForward*60;
    walkTime+=0.12;

    const s=Math.sin(walkTime)*0.8;
    penguin.userData.legs.right.rotation.x=s;
    penguin.userData.legs.left.rotation.x=-s;
    penguin.rotation.z=-Math.sin(walkTime)*0.12;
    penguin.position.y=Math.max(0,Math.cos(walkTime))*0.07;
  }else{
    penguin.position.y*=.9;
    penguin.rotation.z*=.9;
  }

  ground.position.z=worldZ;
  groundMaterial.map.offset.y=worldZ*0.06+Math.sin(walkTime)*0.01;

  recycleMountains();
  updateCamera();
  renderer.render(scene,camera);
}

window.addEventListener("resize",()=>{
  camera.aspect=innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth,innerHeight);
});
</script>
</body>
</html>